# Wave Visualizer（波形ビジュアライザー）

リアルタイム音声可視化と FFT 分解による音声再現実験のための Web アプリケーション

## 🎯 プロジェクトの目的

このアプリケーションは、**録音した音声を FFT（高速フーリエ変換）で周波数成分に分解し、その正弦波を加算して元の音声を再現する実験**を目的として開発されました。音の本質である「すべての音は正弦波の合成で表現できる」というフーリエ級数の原理を体験的に学習できます。

## 🌟 主要機能

### 🎤 音声録音・再生

- **3 秒間の高品質録音**（48kHz サンプリング）
- **リアルタイム波形表示**（緑色オシロスコープ）
- **録音音声の再生機能**

### 📊 リアルタイム可視化

- **時間軸波形表示**（1200×200 ピクセル）
- **周波数スペクトラム表示**（リアルタイム FFT）
- **周波数グリッド**（500Hz 間隔、ラベル付き）

### 🔬 FFT 解析・音声再現

- **高精度 FFT 解析**（2048 サンプル、ハミング窓適用）
- **相対振幅保持**（元音声の音量比率を正確に維持）
- **上位 100 成分の抽出・表示**
- **インタラクティブ正弦波再生**（チェックボックス操作）

## 🚀 使用方法

### 基本的な実験手順

1. **初期化**

   ```
   「Initialize」ボタンをクリック
   → マイクアクセス許可
   → リアルタイム可視化開始
   ```

2. **音声録音**

   ```
   「Record」ボタンをクリック
   → 3秒間録音（口笛や「あー」等の単純な音推奨）
   → 自動停止
   ```

3. **元音声確認**

   ```
   「Playback」ボタンをクリック
   → 録音した音声を再生
   ```

4. **FFT 解析**

   ```
   「Analyse」ボタンをクリック
   → 周波数成分に分解
   → 相対振幅付きリスト表示
   ```

5. **音声再現実験**

   ```
   ★1（最大成分）をチェック → 基本周波数を確認
   ★2を追加 → 音の質感変化を体験
   ★3以降を順次追加 → 元音声に近づく過程を観察
   ```

6. **実験終了**
   ```
   「Stop Sine Waves」ボタンで全ての正弦波を停止
   ```

### 📈 結果の読み方

| 表示項目       | 説明                                     |
| -------------- | ---------------------------------------- |
| ★1〜★10        | 重要度の高い周波数成分（太字・緑色表示） |
| 相対音量       | 最大成分に対する比率（0.000〜1.000）     |
| パーセント表示 | 相対音量の百分率（0%〜100%）             |
| 背景色         | 50%以上：緑、10%以上：薄緑               |

## 💡 実験のコツ

### 推奨する録音音声

- **口笛**：単純な基本周波数と倍音
- **母音（あ・え・い・お・う）**：明確な倍音構造
- **楽器音**：ピアノ、笛など単音
- **避けるべき音**：ノイズ、複雑な音楽、話し声

### 効果的な実験方法

1. **段階的追加**：★1 から順番にチェック
2. **音量比較**：各成分の相対音量を意識
3. **元音との比較**：Playback と正弦波合成を聞き比べ
4. **成分数の影響**：少数成分 vs 多数成分の違いを体験

## 🛠 技術仕様

### システム要件

- **ブラウザ**：Chrome 66+, Firefox 60+, Safari 11.1+
- **マイク**：任意の音声入力デバイス
- **インターネット**：不要（ローカル実行可能）

### 音声処理仕様

```
サンプリング周波数: 48kHz（ブラウザ依存）
録音時間: 3秒間
FFTサイズ: 2048サンプル
窓関数: ハミング窓
周波数分解能: 23.4Hz（48kHz時）
表示成分数: 最大100成分
```

### ファイル構成

```
waveVisualizer/
├── index.html              # メインUI（ボタン・キャンバス）
├── main.js                 # 音声録音・再生・初期化
├── waveVisualizer.js       # リアルタイム波形表示
├── spectrumVisualizer.js   # リアルタイムスペクトラム表示
├── sinewaveAnalyser.js     # FFT解析・正弦波再生
└── README.md               # このファイル
```

## 🖥 ローカル実行方法

### Python 使用（推奨）

```bash
# プロジェクトディレクトリに移動
cd waveVisualizer

# ローカルサーバー起動
python3 -m http.server 8000

# ブラウザでアクセス
open http://localhost:8000
```

### Node.js 使用

```bash
npx http-server -p 8000
```

### 直接ブラウザ（制限あり）

```bash
# ChromeでCORSを無効化して起動
google-chrome --disable-web-security --user-data-dir=/tmp/chrome
```

## 🔧 トラブルシューティング

### マイクアクセスが許可されない

- **HTTPS または localhost**でアクセス
- ブラウザのマイク許可設定を確認
- プライベートモードを無効化

### 音が聞こえない

- システム音量を確認
- ブラウザの音声出力設定を確認
- 「Initialize」を再実行

### 解析結果が 0 件

- 録音時に実際に音を出す
- マイクの音量レベルを確認
- 静かな環境で録音

### 正弦波が雑音になる

- **上位成分から順番に**選択
- 一度に多数選択せず**段階的に追加**
- 口笛などの**単純な音**で実験

## 📚 教育的価値

### 学習できる概念

- **フーリエ変換の原理**：時間軸 ↔ 周波数軸変換
- **音の本質**：すべての音は正弦波の合成
- **倍音構造**：基本周波数と整数倍の関係
- **相対振幅**：音の質感を決める要素
- **スペクトラム解析**：音響工学の基礎

### 実験から分かること

1. **★1（基本周波数）**が音の「高さ」を決定
2. **★2 以降（倍音）**が音の「質感・音色」を決定
3. **相対振幅**が正確でないと元音にならない
4. **成分数**が多いほど元音に近づく

## 🔬 発展的実験

### 高度な実験アイデア

- **楽器音の分析**：ピアノ・バイオリン・フルートの違い
- **母音の比較**：あ・え・い・お・うの倍音構造
- **音量の影響**：大きな音 vs 小さな音のスペクトラム
- **録音品質の影響**：ノイズありなしの比較

## 🤝 貢献・改善

### 改善提案

- 位相情報の保持
- より高次の FFT（4096 サンプル）
- 楽器音データベース
- 教育用ガイド機能

## 📄 ライセンス

MIT License - 教育・研究目的での自由利用を許可

## 👨‍💻 開発者情報

**目的**: 音響工学・信号処理の教育支援  
**技術**: Web Audio API, Canvas 2D API, JavaScript ES6+  
**特徴**: 外部ライブラリ不要、ブラウザのみで完結

---

**🎵 音の世界を FFT で探求しよう！ 🎵**
